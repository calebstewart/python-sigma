
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sigma.schema module &#8212; Python Sigma 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/readable.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sigma.util module" href="sigma.util.html" />
    <link rel="prev" title="sigma.mitre module" href="sigma.mitre.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sigma.util.html" title="sigma.util module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sigma.mitre.html" title="sigma.mitre module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python Sigma 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="sigma.html" accesskey="U">sigma package</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">sigma.schema module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-sigma.schema">
<span id="sigma-schema-module"></span><h1>sigma.schema module<a class="headerlink" href="#module-sigma.schema" title="Permalink to this headline">¶</a></h1>
<p>Sigma rule schema is the core functionality of this package. The rule schema allows
you to generically read and write Sigma rules in Python. Rules can be loaded from
a dictionary or directly from a YAML file. You can also reproduce compliant Sigma
rules from in-memory representations with the <a class="reference internal" href="#sigma.schema.Rule.to_sigma" title="sigma.schema.Rule.to_sigma"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Rule.to_sigma()</span></code></a> method. This
can be used to load, modify and save sigma rules without conversion if needed.</p>
<p>Sigma rule detection conditions can also be parsed using the <code class="docutils literal notranslate"><span class="pre">pyparsing</span></code> package
into a python-native format, which is normally used in conjunction with a serializer.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Loading and Inspecting a Rule</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sigma.schema</span> <span class="kn">import</span> <span class="n">Rule</span>

<span class="n">rule</span> <span class="o">=</span> <span class="n">Rule</span><span class="o">.</span><span class="n">from_yaml</span><span class="p">(</span><span class="s2">&quot;path/to/rule.yml&quot;</span><span class="p">)</span>

<span class="c1"># Retrieve common properties</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">detection</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>

<span class="c1"># Retrieve a parsed expression representing the full detection condition</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">detection</span><span class="o">.</span><span class="n">expression</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">BaseCorrelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'correlation'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.CorrelationType" title="sigma.schema.CorrelationType"><span class="pre">sigma.schema.CorrelationType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">timespan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sigma.schema.ConstrainedStrValue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.RuleLevel" title="sigma.schema.RuleLevel"><span class="pre">sigma.schema.RuleLevel</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.BaseCorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation.action">
<span class="sig-name descname"><span class="pre">action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'correlation'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.BaseCorrelation.action" title="Permalink to this definition">¶</a></dt>
<dd><p>A correlation action</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation.group_by">
<span class="sig-name descname"><span class="pre">group_by</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.BaseCorrelation.group_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional field to group results by</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation.level">
<span class="sig-name descname"><span class="pre">level</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.RuleLevel" title="sigma.schema.RuleLevel"><span class="pre">sigma.schema.RuleLevel</span></a></em><a class="headerlink" href="#sigma.schema.BaseCorrelation.level" title="Permalink to this definition">¶</a></dt>
<dd><p>A rule level to apply to the correlation of all rules</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sigma.schema.BaseCorrelation.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of this correlation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation.rule">
<span class="sig-name descname"><span class="pre">rule</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.BaseCorrelation.rule" title="Permalink to this definition">¶</a></dt>
<dd><p>List of rule titles or correlation names also specified in the same file.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation.timespan">
<span class="sig-name descname"><span class="pre">timespan</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sigma.schema.BaseCorrelation.timespan" title="Permalink to this definition">¶</a></dt>
<dd><p>A timespan used for correlating events (e.g. 5m, 3d or 30s)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.BaseCorrelation.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.CorrelationType" title="sigma.schema.CorrelationType"><span class="pre">sigma.schema.CorrelationType</span></a></em><a class="headerlink" href="#sigma.schema.BaseCorrelation.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of correlation to be used</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.Correlation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">Correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.CountCorrelation" title="sigma.schema.CountCorrelation"><span class="pre">sigma.schema.CountCorrelation</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.TemporalCorrelation" title="sigma.schema.TemporalCorrelation"><span class="pre">sigma.schema.TemporalCorrelation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.Correlation" title="sigma.schema.Correlation"><span class="pre">sigma.schema.Correlation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.Correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An object representing a collection of rules bound by a correlation</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CorrelationGreaterThan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CorrelationGreaterThan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.CorrelationGreaterThan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.CorrelationSimpleCondition" title="sigma.schema.CorrelationSimpleCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.CorrelationSimpleCondition</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationGreaterThan.gt">
<span class="sig-name descname"><span class="pre">gt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sigma.schema.CorrelationGreaterThan.gt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CorrelationGreaterThanEqual">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CorrelationGreaterThanEqual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gte</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.CorrelationGreaterThanEqual" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.CorrelationSimpleCondition" title="sigma.schema.CorrelationSimpleCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.CorrelationSimpleCondition</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationGreaterThanEqual.gte">
<span class="sig-name descname"><span class="pre">gte</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sigma.schema.CorrelationGreaterThanEqual.gte" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CorrelationLessThan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CorrelationLessThan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.CorrelationLessThan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.CorrelationSimpleCondition" title="sigma.schema.CorrelationSimpleCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.CorrelationSimpleCondition</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationLessThan.lt">
<span class="sig-name descname"><span class="pre">lt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sigma.schema.CorrelationLessThan.lt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CorrelationLessThanEqual">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CorrelationLessThanEqual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lte</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.CorrelationLessThanEqual" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.CorrelationSimpleCondition" title="sigma.schema.CorrelationSimpleCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.CorrelationSimpleCondition</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationLessThanEqual.lte">
<span class="sig-name descname"><span class="pre">lte</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sigma.schema.CorrelationLessThanEqual.lte" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CorrelationRange">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CorrelationRange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sigma.schema.ConstrainedStrValue</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.CorrelationRange" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="sigma.schema.CorrelationRange.maximum">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maximum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sigma.schema.CorrelationRange.maximum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sigma.schema.CorrelationRange.minimum">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">minimum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sigma.schema.CorrelationRange.minimum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationRange.range">
<span class="sig-name descname"><span class="pre">range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sigma.schema.CorrelationRange.range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CorrelationSimpleCondition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CorrelationSimpleCondition</span></span><a class="headerlink" href="#sigma.schema.CorrelationSimpleCondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="sigma.schema.CorrelationSimpleCondition.value">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#sigma.schema.CorrelationSimpleCondition.value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CorrelationType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CorrelationType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.CorrelationType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationType.EVENT_COUNT">
<span class="sig-name descname"><span class="pre">EVENT_COUNT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'event_count'</span></em><a class="headerlink" href="#sigma.schema.CorrelationType.EVENT_COUNT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationType.TEMPORAL">
<span class="sig-name descname"><span class="pre">TEMPORAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'temporal'</span></em><a class="headerlink" href="#sigma.schema.CorrelationType.TEMPORAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CorrelationType.VALUE_COUNT">
<span class="sig-name descname"><span class="pre">VALUE_COUNT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'value_count'</span></em><a class="headerlink" href="#sigma.schema.CorrelationType.VALUE_COUNT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.CountCorrelation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">CountCorrelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">*,</span> <span class="pre">action:</span> <span class="pre">typing.Literal['correlation'],</span> <span class="pre">name:</span> <span class="pre">str,</span> <span class="pre">rule:</span> <span class="pre">typing.Union[str,</span> <span class="pre">typing.List[str]],</span> <span class="pre">type:</span> <span class="pre">typing.Union[typing.Literal[&lt;CorrelationType.EVENT_COUNT:</span> <span class="pre">'event_count'&gt;],</span> <span class="pre">typing.Literal[&lt;CorrelationType.VALUE_COUNT:</span> <span class="pre">'value_count'&gt;]],</span> <span class="pre">timespan:</span> <span class="pre">sigma.schema.ConstrainedStrValue,</span> <span class="pre">level:</span> <span class="pre">sigma.schema.RuleLevel,</span> <span class="pre">condition:</span> <span class="pre">typing.Union[sigma.schema.CorrelationLessThan,</span> <span class="pre">sigma.schema.CorrelationLessThanEqual,</span> <span class="pre">sigma.schema.CorrelationGreaterThan,</span> <span class="pre">sigma.schema.CorrelationGreaterThanEqual,</span> <span class="pre">sigma.schema.CorrelationRange],</span> <span class="pre">**extra_data:</span> <span class="pre">typing.Any</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.CountCorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.BaseCorrelation" title="sigma.schema.BaseCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.BaseCorrelation</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CountCorrelation.condition">
<span class="sig-name descname"><span class="pre">condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.CorrelationLessThan" title="sigma.schema.CorrelationLessThan"><span class="pre">sigma.schema.CorrelationLessThan</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.CorrelationLessThanEqual" title="sigma.schema.CorrelationLessThanEqual"><span class="pre">sigma.schema.CorrelationLessThanEqual</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.CorrelationGreaterThan" title="sigma.schema.CorrelationGreaterThan"><span class="pre">sigma.schema.CorrelationGreaterThan</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.CorrelationGreaterThanEqual" title="sigma.schema.CorrelationGreaterThanEqual"><span class="pre">sigma.schema.CorrelationGreaterThanEqual</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.CorrelationRange" title="sigma.schema.CorrelationRange"><span class="pre">sigma.schema.CorrelationRange</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.CountCorrelation.condition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.CountCorrelation.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union[Literal[&lt;CorrelationType.EVENT_COUNT:</span> <span class="pre">'event_count'&gt;],</span> <span class="pre">Literal[&lt;CorrelationType.VALUE_COUNT:</span> <span class="pre">'value_count'&gt;]]</span></em><a class="headerlink" href="#sigma.schema.CountCorrelation.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of correlation to be used</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.IncludeSchema">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">IncludeSchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'include'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pydantic.types.FilePath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.IncludeSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Defines a YAML document which includes an outside rule or correlation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.IncludeSchema.action">
<span class="sig-name descname"><span class="pre">action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'include'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.IncludeSchema.action" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.IncludeSchema.filename">
<span class="sig-name descname"><span class="pre">filename</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pydantic.types.FilePath</span></em><a class="headerlink" href="#sigma.schema.IncludeSchema.filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.IncludeSchema.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a></span></span><a class="headerlink" href="#sigma.schema.IncludeSchema.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the specified included file</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.LowercaseString">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">LowercaseString</span></span><a class="headerlink" href="#sigma.schema.LowercaseString" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.Rule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">Rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sigma.schema.ConstrainedStrValue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.RuleRelation" title="sigma.schema.RuleRelation"><span class="pre">sigma.schema.RuleRelation</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.RuleStatus" title="sigma.schema.RuleStatus"><span class="pre">sigma.schema.RuleStatus</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sigma.schema.ConstrainedStrValue</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">author</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">license</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">references</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logsource</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.RuleLogSource" title="sigma.schema.RuleLogSource"><span class="pre">sigma.schema.RuleLogSource</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.RuleDetection" title="sigma.schema.RuleDetection"><span class="pre">sigma.schema.RuleDetection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">falsepositives</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.RuleLevel" title="sigma.schema.RuleLevel"><span class="pre">sigma.schema.RuleLevel</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.RuleTag" title="sigma.schema.RuleTag"><span class="pre">sigma.schema.RuleTag</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.SimpleDate" title="sigma.schema.SimpleDate"><span class="pre">sigma.schema.SimpleDate</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modified</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.SimpleDate" title="sigma.schema.SimpleDate"><span class="pre">sigma.schema.SimpleDate</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.Rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Sigma Rule Specification</p>
<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.Rule.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Config</span></span><a class="headerlink" href="#sigma.schema.Rule.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.Config.extra">
<span class="sig-name descname"><span class="pre">extra</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'allow'</span></em><a class="headerlink" href="#sigma.schema.Rule.Config.extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.Config.schema_extra">
<span class="sig-name descname"><span class="pre">schema_extra</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'examples':</span> <span class="pre">[{'title':</span> <span class="pre">'Windows</span> <span class="pre">Credential</span> <span class="pre">Editor',</span> <span class="pre">'id':</span> <span class="pre">'7aa7009a-28b9-4344-8c1f-159489a390df',</span> <span class="pre">'description':</span> <span class="pre">'Detects</span> <span class="pre">the</span> <span class="pre">use</span> <span class="pre">of</span> <span class="pre">Windows</span> <span class="pre">Credential</span> <span class="pre">Editor</span> <span class="pre">(WCE)',</span> <span class="pre">'status':</span> <span class="pre">'experimental',</span> <span class="pre">'author':</span> <span class="pre">'Florian</span> <span class="pre">Roth',</span> <span class="pre">'references':</span> <span class="pre">['https://www.ampliasecurity.com/research/windows-credentials-editor/'],</span> <span class="pre">'date':</span> <span class="pre">'2019/12/31',</span> <span class="pre">'modified':</span> <span class="pre">'2021/07/15',</span> <span class="pre">'tags':</span> <span class="pre">['attack.credential_access',</span> <span class="pre">'attack.t1003.001',</span> <span class="pre">'attack.s0005'],</span> <span class="pre">'logsource':</span> <span class="pre">{'category':</span> <span class="pre">'process_creation',</span> <span class="pre">'product':</span> <span class="pre">'windows'},</span> <span class="pre">'detection':</span> <span class="pre">{'selection1':</span> <span class="pre">{'Imphash':</span> <span class="pre">['a53a02b997935fd8eedcb5f7abab9b9f',</span> <span class="pre">'e96a73c7bf33a464c510ede582318bf2']},</span> <span class="pre">'selection2':</span> <span class="pre">{'CommandLine|endswith':</span> <span class="pre">'.exe</span> <span class="pre">-S',</span> <span class="pre">'ParentImage|endswith':</span> <span class="pre">'\\services.exe'},</span> <span class="pre">'filter':</span> <span class="pre">{'Image|endswith':</span> <span class="pre">'\\clussvc.exe'},</span> <span class="pre">'condition':</span> <span class="pre">'(</span> <span class="pre">selection1</span> <span class="pre">or</span> <span class="pre">selection2</span> <span class="pre">)</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">filter'},</span> <span class="pre">'falsepositives':</span> <span class="pre">['Another</span> <span class="pre">service</span> <span class="pre">that</span> <span class="pre">uses</span> <span class="pre">a</span> <span class="pre">single</span> <span class="pre">-s</span> <span class="pre">command</span> <span class="pre">line</span> <span class="pre">switch'],</span> <span class="pre">'level':</span> <span class="pre">'critical'}]}</span></em><a class="headerlink" href="#sigma.schema.Rule.Config.schema_extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.author">
<span class="sig-name descname"><span class="pre">author</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.author" title="Permalink to this definition">¶</a></dt>
<dd><p>Creator of the rule</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.date">
<span class="sig-name descname"><span class="pre">date</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.SimpleDate" title="sigma.schema.SimpleDate"><span class="pre">sigma.schema.SimpleDate</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.date" title="Permalink to this definition">¶</a></dt>
<dd><p>The date the rule was created. This should be YYYY-MM-DD or YYYY/MM/DD. If
the field is not formatted in this way, it will be saved as a simple string.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.description" title="Permalink to this definition">¶</a></dt>
<dd><p>A short description of the rule and the malicious activity that can be
detected (max. 65,535 characters).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.detection">
<span class="sig-name descname"><span class="pre">detection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.RuleDetection" title="sigma.schema.RuleDetection"><span class="pre">sigma.schema.RuleDetection</span></a></em><a class="headerlink" href="#sigma.schema.Rule.detection" title="Permalink to this definition">¶</a></dt>
<dd><p>A set of search-identifiers that represent searches on log data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.falsepositives">
<span class="sig-name descname"><span class="pre">falsepositives</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.falsepositives" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of known false positives that may occur.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.fields">
<span class="sig-name descname"><span class="pre">fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.fields" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of log fields that could be interesting in further analysis of the
event and should be displayed to the analyst.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.Rule.from_sigma">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">definition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a></span></span><a class="headerlink" href="#sigma.schema.Rule.from_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for parse_obj to be more expressive</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.Rule.from_yaml">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a></span></span><a class="headerlink" href="#sigma.schema.Rule.from_yaml" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a rule from a YAML file</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">uuid.UUID</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Sigma rules should be identified by a globally unique identifier in the id
attribute.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.level">
<span class="sig-name descname"><span class="pre">level</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.RuleLevel" title="sigma.schema.RuleLevel"><span class="pre">sigma.schema.RuleLevel</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.level" title="Permalink to this definition">¶</a></dt>
<dd><p>The level field contains one of five string values. It describes the
criticality of a triggered rule.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.license">
<span class="sig-name descname"><span class="pre">license</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.license" title="Permalink to this definition">¶</a></dt>
<dd><p>SPDX License Name</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.logsource">
<span class="sig-name descname"><span class="pre">logsource</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.RuleLogSource" title="sigma.schema.RuleLogSource"><span class="pre">sigma.schema.RuleLogSource</span></a></em><a class="headerlink" href="#sigma.schema.Rule.logsource" title="Permalink to this definition">¶</a></dt>
<dd><p>This section describes the log data on which the detection is meant to be
applied to. It describes the log source, the platform, the application and the
type that is required in detection.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.modified">
<span class="sig-name descname"><span class="pre">modified</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.SimpleDate" title="sigma.schema.SimpleDate"><span class="pre">sigma.schema.SimpleDate</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.modified" title="Permalink to this definition">¶</a></dt>
<dd><p>The date the rule was last modified. This should be YYYY-MM-DD or YYYY/MM/DD.
If the field is not formatted in this way, it will be saved as a simple string.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.Rule.parse_obj">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a></span></span><a class="headerlink" href="#sigma.schema.Rule.parse_obj" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.references">
<span class="sig-name descname"><span class="pre">references</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.references" title="Permalink to this definition">¶</a></dt>
<dd><p>References to the source that the rule was derived from. These could be
blog articles, technical papers, presentations or even tweets.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.related">
<span class="sig-name descname"><span class="pre">related</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.RuleRelation" title="sigma.schema.RuleRelation"><span class="pre">sigma.schema.RuleRelation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.related" title="Permalink to this definition">¶</a></dt>
<dd><p>List of rule IDs and associated relationships to this rule.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.status">
<span class="sig-name descname"><span class="pre">status</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.RuleStatus" title="sigma.schema.RuleStatus"><span class="pre">sigma.schema.RuleStatus</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Declares the status of the rule.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.tags">
<span class="sig-name descname"><span class="pre">tags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.RuleTag" title="sigma.schema.RuleTag"><span class="pre">sigma.schema.RuleTag</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.Rule.tags" title="Permalink to this definition">¶</a></dt>
<dd><p>A Sigma rule can be categorised with tags.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.Rule.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sigma.schema.Rule.title" title="Permalink to this definition">¶</a></dt>
<dd><p>A brief title for the rule that should contain what the rules is supposed
to detect (max. 256 characters).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.Rule.to_sigma">
<span class="sig-name descname"><span class="pre">to_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sigma.schema.Rule.to_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert this rule back into a JSON-serializable dictionary representing
the sigma rule. This dictionary can safely be converted to JSON or YAML and
written back to disk as a valid Sigma rule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.Rule.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">sigma.transorms.Transformation</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">Rule</span></a></span></span><a class="headerlink" href="#sigma.schema.Rule.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply all transformations to this rule and all condition expressions</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleDetection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sigma.schema.ConstrainedStrValue</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleDetection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Defines the detection criteria for this rule including the timeframe,
condition specification and any number of detection field lists/keywords
grouped by arbitrary names.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Config</span></span><a class="headerlink" href="#sigma.schema.RuleDetection.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.Config.extra">
<span class="sig-name descname"><span class="pre">extra</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'allow'</span></em><a class="headerlink" href="#sigma.schema.RuleDetection.Config.extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.Config.schema_extra">
<span class="sig-name descname"><span class="pre">schema_extra</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'examples':</span> <span class="pre">[{'timeframe':</span> <span class="pre">'5m',</span> <span class="pre">'condition':</span> <span class="pre">'(selection1</span> <span class="pre">or</span> <span class="pre">selection2)</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">filter',</span> <span class="pre">'selection1':</span> <span class="pre">{'Imphash':</span> <span class="pre">['a53a02b997935fd8eedcb5f7abab9b9f',</span> <span class="pre">'e96a73c7bf33a464c510ede582318bf2']},</span> <span class="pre">'selection2':</span> <span class="pre">{'CommandLine|endswith':</span> <span class="pre">'.exe</span> <span class="pre">-S',</span> <span class="pre">'ParentImage|endswith':</span> <span class="pre">'\\services.exe'},</span> <span class="pre">'filter':</span> <span class="pre">{'Image|endswith':</span> <span class="pre">'\\clussvc.exe'}}]}</span></em><a class="headerlink" href="#sigma.schema.RuleDetection.Config.schema_extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.GRAMMAR_PARSER">
<span class="sig-name descname"><span class="pre">GRAMMAR_PARSER</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Forward:</span> <span class="pre">'or'</span> <span class="pre">term</span></em><a class="headerlink" href="#sigma.schema.RuleDetection.GRAMMAR_PARSER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.condition">
<span class="sig-name descname"><span class="pre">condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.RuleDetection.condition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.expression">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expression</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="sigma.grammar.html#sigma.grammar.Expression" title="sigma.grammar.Expression"><span class="pre">sigma.grammar.Expression</span></a></em><a class="headerlink" href="#sigma.schema.RuleDetection.expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.get_expression">
<span class="sig-name descname"><span class="pre">get_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="sigma.grammar.html#sigma.grammar.Expression" title="sigma.grammar.Expression"><span class="pre">sigma.grammar.Expression</span></a></span></span><a class="headerlink" href="#sigma.schema.RuleDetection.get_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an expression from the specified identifier. If the requested
identifier does not exist, a MissingIdentifier exception is raised.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.lookup_expression">
<span class="sig-name descname"><span class="pre">lookup_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sigma.schema.RuleDetection.lookup_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Lookup identifier expressions by a glob pattern</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.parse_grammar">
<span class="sig-name descname"><span class="pre">parse_grammar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="sigma.grammar.html#sigma.grammar.Expression" title="sigma.grammar.Expression"><span class="pre">sigma.grammar.Expression</span></a></span></span><a class="headerlink" href="#sigma.schema.RuleDetection.parse_grammar" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the condition and evaluate fields to produce a single
search expression.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.post_init">
<span class="sig-name descname"><span class="pre">post_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleDetection.post_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.rule">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rule</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a></em><a class="headerlink" href="#sigma.schema.RuleDetection.rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.timeframe">
<span class="sig-name descname"><span class="pre">timeframe</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.RuleDetection.timeframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">Rule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">transforms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sigma.transform.html#sigma.transform.Transformation" title="sigma.transform.Transformation"><span class="pre">sigma.transform.Transformation</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleDetection.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform all expressions with the given transformations</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.update_expression">
<span class="sig-name descname"><span class="pre">update_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sigma.grammar.html#sigma.grammar.Expression" title="sigma.grammar.Expression"><span class="pre">sigma.grammar.Expression</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleDetection.update_expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetection.validate_detection">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleDetection.validate_detection" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate the schema for the</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleDetectionFields">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleDetectionFields</span></span><a class="headerlink" href="#sigma.schema.RuleDetectionFields" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Any</span></code>]</p>
<p>Defines the detection criteria by AND-separated field matching.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetectionFields.build_expression">
<span class="sig-name descname"><span class="pre">build_expression</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="sigma.grammar.html#sigma.grammar.Expression" title="sigma.grammar.Expression"><span class="pre">sigma.grammar.Expression</span></a></span></span><a class="headerlink" href="#sigma.schema.RuleDetectionFields.build_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the logical AND expression for these keywords</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleDetectionList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleDetectionList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleDetectionList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <a class="reference internal" href="#sigma.schema.RuleDetectionFields" title="sigma.schema.RuleDetectionFields"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.RuleDetectionFields</span></code></a>]]</p>
<p>Defines the detection criteria by OR-separated keyword strings.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleDetectionList.build_expression">
<span class="sig-name descname"><span class="pre">build_expression</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="sigma.grammar.html#sigma.grammar.Expression" title="sigma.grammar.Expression"><span class="pre">sigma.grammar.Expression</span></a></span></span><a class="headerlink" href="#sigma.schema.RuleDetectionList.build_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the logical OR expression for these keywords</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleLevel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleLevel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.LowercaseString" title="sigma.schema.LowercaseString"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.LowercaseString</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>The level field contains one of five string values. It describes the
criticality of a triggered rule. While low and medium level events have an
informative character, events with high and critical level should lead to
immediate reviews by security analysts.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLevel.CRITICAL">
<span class="sig-name descname"><span class="pre">CRITICAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'critical'</span></em><a class="headerlink" href="#sigma.schema.RuleLevel.CRITICAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Highly relevant event that indicates an incident. Critical events should
be reviewed immediately.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLevel.HIGH">
<span class="sig-name descname"><span class="pre">HIGH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'high'</span></em><a class="headerlink" href="#sigma.schema.RuleLevel.HIGH" title="Permalink to this definition">¶</a></dt>
<dd><p>Relevant event that should trigger an internal alert and requires a
prompt review.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLevel.INFORMATIONAL">
<span class="sig-name descname"><span class="pre">INFORMATIONAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'informational'</span></em><a class="headerlink" href="#sigma.schema.RuleLevel.INFORMATIONAL" title="Permalink to this definition">¶</a></dt>
<dd><p>Rule is intended for enrichment of events, e.g. by tagging them. No case
or alerting should be triggered by such rules because it is expected that a
huge amount of events will match these rules.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLevel.LOW">
<span class="sig-name descname"><span class="pre">LOW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'low'</span></em><a class="headerlink" href="#sigma.schema.RuleLevel.LOW" title="Permalink to this definition">¶</a></dt>
<dd><p>Notable event but rarely an incident. Low rated events can be relevant
in high numbers or combination with others. Immediate reaction shouldn’t be
necessary, but a regular review is recommended.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLevel.MEDIUM">
<span class="sig-name descname"><span class="pre">MEDIUM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'medium'</span></em><a class="headerlink" href="#sigma.schema.RuleLevel.MEDIUM" title="Permalink to this definition">¶</a></dt>
<dd><p>Relevant event that should be reviewed manually on a more frequent basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleLevel.to_severity">
<span class="sig-name descname"><span class="pre">to_severity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sigma.schema.RuleLevel.to_severity" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the rule level to an integer severity level in the range 0-100</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleLicense">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleLicense</span></span><a class="headerlink" href="#sigma.schema.RuleLicense" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
<p>License of the rule according the SPDX ID specification.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleLogSource">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleLogSource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">product</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">definition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleLogSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Defines the source of log entries for a sigma rule</p>
<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleLogSource.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Config</span></span><a class="headerlink" href="#sigma.schema.RuleLogSource.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLogSource.Config.extra">
<span class="sig-name descname"><span class="pre">extra</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'allow'</span></em><a class="headerlink" href="#sigma.schema.RuleLogSource.Config.extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLogSource.category">
<span class="sig-name descname"><span class="pre">category</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.RuleLogSource.category" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLogSource.definition">
<span class="sig-name descname"><span class="pre">definition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.RuleLogSource.definition" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLogSource.product">
<span class="sig-name descname"><span class="pre">product</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.RuleLogSource.product" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleLogSource.service">
<span class="sig-name descname"><span class="pre">service</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.RuleLogSource.service" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleRelation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleRelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uuid.UUID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sigma.schema.RuleRelationType" title="sigma.schema.RuleRelationType"><span class="pre">sigma.schema.RuleRelationType</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleRelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Defines detections/queries for this rule</p>
<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleRelation.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Config</span></span><a class="headerlink" href="#sigma.schema.RuleRelation.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleRelation.Config.schema_extra">
<span class="sig-name descname"><span class="pre">schema_extra</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'examples':</span> <span class="pre">[{'id':</span> <span class="pre">'7aa7009a-28b9-4344-8c1f-159489a390df',</span> <span class="pre">'type':</span> <span class="pre">'derived'}]}</span></em><a class="headerlink" href="#sigma.schema.RuleRelation.Config.schema_extra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleRelation.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">uuid.UUID</span></em><a class="headerlink" href="#sigma.schema.RuleRelation.id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleRelation.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.RuleRelationType" title="sigma.schema.RuleRelationType"><span class="pre">sigma.schema.RuleRelationType</span></a></em><a class="headerlink" href="#sigma.schema.RuleRelation.type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleRelationType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleRelationType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleRelationType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.LowercaseString" title="sigma.schema.LowercaseString"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.LowercaseString</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Type of rule relationship</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleRelationType.DERIVED">
<span class="sig-name descname"><span class="pre">DERIVED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'derived'</span></em><a class="headerlink" href="#sigma.schema.RuleRelationType.DERIVED" title="Permalink to this definition">¶</a></dt>
<dd><p>Rule was derived from the referred rule or rules, which may remain active.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleRelationType.MERGED">
<span class="sig-name descname"><span class="pre">MERGED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'merged'</span></em><a class="headerlink" href="#sigma.schema.RuleRelationType.MERGED" title="Permalink to this definition">¶</a></dt>
<dd><p>Rule was merged from the referred rules. The rules may be still existing and in use.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleRelationType.OBSOLETES">
<span class="sig-name descname"><span class="pre">OBSOLETES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'obsoletes'</span></em><a class="headerlink" href="#sigma.schema.RuleRelationType.OBSOLETES" title="Permalink to this definition">¶</a></dt>
<dd><p>Rule obsoletes the referred rule or rules, which aren’t used anymore.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleRelationType.RENAMED">
<span class="sig-name descname"><span class="pre">RENAMED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'renamed'</span></em><a class="headerlink" href="#sigma.schema.RuleRelationType.RENAMED" title="Permalink to this definition">¶</a></dt>
<dd><p>The rule had previously the referred identifier or identifiers but was renamed
for any other reason, e.g. from a private naming scheme to UUIDs, to resolve
collisions etc. It’s not expected that a rule with this id exists anymore.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleStatus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleStatus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.LowercaseString" title="sigma.schema.LowercaseString"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.LowercaseString</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Indicates the development status for a sigma rule</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleStatus.DEPRECATED">
<span class="sig-name descname"><span class="pre">DEPRECATED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'deprecated'</span></em><a class="headerlink" href="#sigma.schema.RuleStatus.DEPRECATED" title="Permalink to this definition">¶</a></dt>
<dd><p>the rule is replace or cover by another one. The link is made by the
related field.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleStatus.EXPERIMENTAL">
<span class="sig-name descname"><span class="pre">EXPERIMENTAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'experimental'</span></em><a class="headerlink" href="#sigma.schema.RuleStatus.EXPERIMENTAL" title="Permalink to this definition">¶</a></dt>
<dd><p>an experimental rule that could lead to false results or be noisy, but
could also identify interesting events.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleStatus.STABLE">
<span class="sig-name descname"><span class="pre">STABLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'stable'</span></em><a class="headerlink" href="#sigma.schema.RuleStatus.STABLE" title="Permalink to this definition">¶</a></dt>
<dd><p>the rule is considered as stable and may be used in production systems
or dashboards.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleStatus.TEST">
<span class="sig-name descname"><span class="pre">TEST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'test'</span></em><a class="headerlink" href="#sigma.schema.RuleStatus.TEST" title="Permalink to this definition">¶</a></dt>
<dd><p>an almost stable rule that possibly could require some fine tuning.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleStatus.TESTING">
<span class="sig-name descname"><span class="pre">TESTING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'testing'</span></em><a class="headerlink" href="#sigma.schema.RuleStatus.TESTING" title="Permalink to this definition">¶</a></dt>
<dd><p>an almost stable rule that possibly could require some fine tuning.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.RuleStatus.UNSUPPORTED">
<span class="sig-name descname"><span class="pre">UNSUPPORTED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'unsupported'</span></em><a class="headerlink" href="#sigma.schema.RuleStatus.UNSUPPORTED" title="Permalink to this definition">¶</a></dt>
<dd><p>the rule can not be use in its current state (special correlation log,
home-made fields)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.RuleTag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">RuleTag</span></span><a class="headerlink" href="#sigma.schema.RuleTag" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
<p>A Sigma rule can be categorised with tags. Tags should generally follow this syntax:</p>
<ul class="simple">
<li><p>Character set: lower-case letters, underscores and hyphens</p></li>
<li><p>no spaces</p></li>
<li><p>Tags are namespaced, the dot is used as separator. e.g. attack.t1234 refers to
technique 1234 in the namespace attack; Namespaces may also be nested</p></li>
<li><p>Keep tags short, e.g. numeric identifiers instead of long sentences</p></li>
<li><p>If applicable, use predefined tags. Feel free to send pull request or issues
with proposals for new tags</p></li>
</ul>
<p>Predefined tags: <a class="reference external" href="https://github.com/SigmaHQ/sigma/wiki/Tags">https://github.com/SigmaHQ/sigma/wiki/Tags</a></p>
<dl class="py property">
<dt class="sig sig-object py" id="sigma.schema.RuleTag.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#sigma.schema.RuleTag.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name is everything after the first period in the tag. If there
are no periods, then the name is an empty string.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sigma.schema.RuleTag.namespace">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">namespace</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sigma.schema.RuleTag.namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>The namespace is everything prior to the first period in the tag</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.RuleTag.validate">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.RuleTag.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.Sigma">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">Sigma</span></span><a class="headerlink" href="#sigma.schema.Sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is never instantiated but provides an object-oriented
interface to loading sigma documents as a whole, which could include
collections of rules bound by correlations and/or an include document
which imports other rules from disk.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sigma.schema.Sigma.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">os.PathLike</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.Correlation" title="sigma.schema.Correlation"><span class="pre">sigma.schema.Correlation</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sigma.schema.Rule" title="sigma.schema.Rule"><span class="pre">sigma.schema.Rule</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sigma.schema.Correlation" title="sigma.schema.Correlation"><span class="pre">sigma.schema.Correlation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sigma.schema.Sigma.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load Sigma rules or correlations from the given path. The return
value of this function is either a singular sigma rule or a correlation
object which represents a list of rules bound by a correlation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.SimpleDate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">SimpleDate</span></span><a class="headerlink" href="#sigma.schema.SimpleDate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></p>
<p>Simple date class which has a custom parser to handle either YYYY/MM/DD or YYYY-MM-DD</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sigma.schema.TemporalCorrelation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sigma.schema.</span></span><span class="sig-name descname"><span class="pre">TemporalCorrelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">*,</span> <span class="pre">action:</span> <span class="pre">typing.Literal['correlation'],</span> <span class="pre">name:</span> <span class="pre">str,</span> <span class="pre">rule:</span> <span class="pre">typing.Union[str,</span> <span class="pre">typing.List[str]],</span> <span class="pre">type:</span> <span class="pre">typing.Literal[&lt;CorrelationType.TEMPORAL:</span> <span class="pre">'temporal'&gt;],</span> <span class="pre">timespan:</span> <span class="pre">sigma.schema.ConstrainedStrValue,</span> <span class="pre">level:</span> <span class="pre">sigma.schema.RuleLevel,</span> <span class="pre">**extra_data:</span> <span class="pre">typing.Any</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sigma.schema.TemporalCorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sigma.schema.BaseCorrelation" title="sigma.schema.BaseCorrelation"><code class="xref py py-class docutils literal notranslate"><span class="pre">sigma.schema.BaseCorrelation</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sigma.schema.TemporalCorrelation.type">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal[&lt;CorrelationType.TEMPORAL:</span> <span class="pre">'temporal'&gt;]</span></em><a class="headerlink" href="#sigma.schema.TemporalCorrelation.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of correlation to be used</p>
</dd></dl>

</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation index</a><ul>
  <li><a href="sigma.html">sigma package</a><ul>
      <li>Previous: <a href="sigma.mitre.html" title="previous chapter">sigma.mitre module</a></li>
      <li>Next: <a href="sigma.util.html" title="next chapter">sigma.util module</a></li>
  </ul></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/sigma.schema.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2022, Caleb Stewart.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.
  </div>
  
  </body>
</html>